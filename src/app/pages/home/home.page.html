<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      To Do
    </ion-title>    
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Nueva tarea</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <app-task-form [categories]="categories" (add)="todo.add($event.title, $event.categoryId)"></app-task-form>
    </ion-card-content>
  </ion-card>  

  <ion-list>
    <ion-item>
      <ion-label>Filtrar por categor√≠a</ion-label>
      <ion-select [(ngModel)]="selectedCat" interface="popover" placeholder="Todas">
        <ion-select-option value="">Todas</ion-select-option>
        <ion-select-option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</ion-select-option>
      </ion-select>
    </ion-item>
  </ion-list>

  <ion-accordion-group [value]="'pending'">
    <ion-accordion value="pending">
      <ion-item slot="header" color="light">
        <ion-label>Tareas pendientes</ion-label>
      </ion-item>
      <div slot="content">
        <ion-list>
          <ion-item *ngFor="let t of incompleteTasks; trackBy: trackTask" (click)="todo.toggle(t.id)">
            <ion-checkbox [checked]="t.completed" slot="start"></ion-checkbox>
            <ion-label>
              <h2>{{ t.title }}</h2>
              <p class="category-label">
                <span class="category-color-dot" [style.background-color]="getCategoryColor(t.categoryId)"></span>
                {{ getCategoryName(t.categoryId) }}
              </p>
            </ion-label>
            <ion-button fill="clear" color="primary" (click)="editTask(t, $event)">
              <ion-icon name="create-outline" slot="icon-only" size="large"></ion-icon>
            </ion-button>
            <ion-button fill="clear" color="danger" (click)="confirmDelete(t.id, $event)">
              <ion-icon name="trash" size="large" slot="icon-only"></ion-icon>
            </ion-button>
          </ion-item>
        </ion-list>
      </div>
    </ion-accordion>

    <ion-accordion value="completed">
      <ion-item slot="header" color="light">
        <ion-label>Tareas completadas</ion-label>
      </ion-item>
      <div slot="content">
        <ion-list>
          <ion-item *ngFor="let t of completedTasks; trackBy: trackTask" (click)="todo.toggle(t.id)">
            <ion-checkbox [checked]="t.completed" slot="start"></ion-checkbox>
            <ion-label>
              <h2>{{ t.title }}</h2>
              <p class="category-label">
                <span class="category-color-dot" [style.background-color]="getCategoryColor(t.categoryId)"></span>
                {{ getCategoryName(t.categoryId) }}
              </p>
            </ion-label>
            <ion-button fill="clear" color="primary" (click)="editTask(t, $event)">
              <ion-icon name="create-outline" slot="icon-only" size="large"></ion-icon>
            </ion-button>
            <ion-button fill="clear" color="danger" (click)="confirmDelete(t.id, $event)">
              <ion-icon name="trash" size="large" slot="icon-only"></ion-icon>
            </ion-button>
          </ion-item>
        </ion-list>
      </div>
    </ion-accordion>
  </ion-accordion-group>
  
</ion-content>

<app-chatbot #chatbot [categories]="categories"></app-chatbot>

<app-badge [chatbot]="chatbot" [enableChatbot]="enableChatbot"></app-badge>
